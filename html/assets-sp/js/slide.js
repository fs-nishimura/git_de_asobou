function SLIDE_CLASS(){$(".active").removeClass("active"),$(".before").removeClass("before"),$(".after").removeClass("after"),PIC.eq(PIC_INDEX).addClass("active"),2==PIC_LEN?CTRL.eq(PIC_INDEX).addClass("active"):0==PIC_INDEX?(PIC.eq(PIC_LEN-1).addClass("before"),PIC.eq(PIC_INDEX+1).addClass("after")):PIC_INDEX==PIC_LEN-1?(PIC.eq(PIC_INDEX-1).addClass("before"),PIC.eq(0).addClass("after")):(PIC.eq(PIC_INDEX-1).addClass("before"),PIC.eq(PIC_INDEX+1).addClass("after")),ACTIVE=$(".slide_wrap ul.pic li.active"),BEFORE=$(".slide_wrap ul.pic li.before"),AFTER=$(".slide_wrap ul.pic li.after"),0==LOAD_FLG?0==FLICK_FLG&&SLIDE_IMG():(LOAD_FLG=!1,SLIDE_SET())}function SLIDE_IMG(){1==NEXT_FLG?(2==PIC_LEN&&(PIC_INDEX=$(".slide_wrap ul.pic li").index($(".slide_wrap ul.pic li.active")),PIC.eq(0).stop(!1,!1).animate({left:"-100%"},SLIDE_SPEED,SLIDE_EASING),PIC.eq(1).stop(!1,!1).animate({left:"0%"},SLIDE_SPEED,SLIDE_EASING)),BEFORE.stop(!1,!1).animate({left:"-100%"},SLIDE_SPEED,SLIDE_EASING)):(AFTER.stop(!1,!1).animate({left:"100%"},SLIDE_SPEED,SLIDE_EASING),2==PIC_LEN&&(PIC_INDEX=$(".slide_wrap ul.pic li").index($(".slide_wrap ul.pic li.active")),PIC.eq(1).stop(!1,!1).animate({left:"100%"},SLIDE_SPEED,SLIDE_EASING),PIC.eq(0).stop(!1,!1).animate({left:"0%"},SLIDE_SPEED,SLIDE_EASING))),ACTIVE.stop(!1,!1).animate({left:"0"},SLIDE_SPEED,SLIDE_EASING,function(){SLIDE_SET()})}function SLIDE_SET(){if(PIC_INDEX=$(".slide_wrap ul.pic li").index($(".slide_wrap ul.pic li.active")),CTRL.eq(PIC_INDEX).addClass("active"),console.log(PIC_INDEX),2==PIC_LEN)1==PIC_INDEX?(PIC.eq(0).css({left:"-100%"}),PIC.eq(1).css({left:"0%"})):0==PIC_INDEX&&(PIC.eq(0).css({left:"0%"}),PIC.eq(1).css({left:"100%"}));else{for(var I=0;PIC_LEN>I;I++)PIC_INDEX>I?PIC.eq(I).css({left:"-100%"}):I>PIC_INDEX?PIC.eq(I).css({left:"100%"}):PIC.eq(I).css({left:"0"});0==PIC_INDEX?PIC.eq(PIC_LEN-1).css({left:"-100%"}):PIC_INDEX==PIC_LEN-1&&PIC.eq(0).css({left:"100%"})}CLICK_FLG=!0,clearTimeout(AUTOTIMER),AUTOTIMER=setTimeout(function(){CLICK_FLG=!1,PIC_INDEX++,PIC_INDEX==PIC_LEN&&(PIC_INDEX=0),NEXT_FLG=!0,SLIDE_CLASS()},AUTOSLIDE_TIME)}function CTRL_CLICK(){OLD_INDEX=PIC_INDEX,PIC_INDEX>CTRL_THIS?(PIC_INDEX=CTRL_THIS,NEXT_FLG=!1):CTRL_THIS>PIC_INDEX&&(PIC_INDEX=CTRL_THIS,NEXT_FLG=!0),FLICK_FLG=!1,SLIDE_IMG_CTRL()}function SLIDE_IMG_CTRL(){$(".old_active").removeClass("old_active"),$(".active").addClass("old_active").removeClass("active"),PIC.eq(PIC_INDEX).addClass("active"),CTRL.eq(PIC_INDEX).addClass("active"),ACTIVE=$(".slide_wrap ul.pic li.active"),OLD=$(".slide_wrap ul.pic li.old_active"),1==NEXT_FLG?0==OLD_INDEX&&PIC_INDEX==PIC_LEN-1?OLD.stop(!1,!1).animate({left:"100%"},SLIDE_SPEED,SLIDE_EASING):OLD.stop(!1,!1).animate({left:"-100%"},SLIDE_SPEED,SLIDE_EASING):0==PIC_INDEX&&OLD_INDEX==PIC_LEN-1?OLD.stop(!1,!1).animate({left:"-100%"},SLIDE_SPEED,SLIDE_EASING):OLD.stop(!1,!1).animate({left:"100%"},SLIDE_SPEED,SLIDE_EASING),ACTIVE.stop(!1,!1).animate({left:"0"},SLIDE_SPEED,SLIDE_EASING,function(){SLIDE_SET()})}function touchHandler(I){var E=I.originalEvent.touches[0];1==CLICK_FLG&&("touchstart"==I.type?(PIC_INDEX=$(".slide_wrap ul.pic li").index($(this)),PIC_W=PIC.width(),winpoint=PIC_W/3,clearTimeout(AUTOTIMER),FLICK_FLG=!0,SLIDE_CLASS(),AFTER_LEFT=AFTER.position().left,BEFORE_LEFT=BEFORE.position().left,startX=E.pageX,startY=E.pageY,diffTime=0,startTime=+new Date):"touchmove"==I.type?(I.preventDefault(),diffX=E.pageX-startX,diffY=E.pageY-startY,PIC_W>Math.abs(diffX)&&(diffX>THRESHOLD?(ACTIVE.css({left:diffX}),BEFORE.css({left:BEFORE_LEFT+diffX})):-THRESHOLD>diffX&&(ACTIVE.css({left:diffX}),AFTER.css({left:AFTER_LEFT+diffX})))):"touchend"==I.type&&(CLICK_FLG=!1,now=+new Date,diffTime=now-startTime,spd=Math.abs((WINW-diffX)/(diffX/diffTime)),spd>FRICK_Latest?spd=FRICK_Latest:spd*=FRICK_SPEED,diffX>winpoint||-diffX>winpoint?diffX>THRESHOLD?(BEFORE.stop(!1,!1).animate({left:"0"},spd,SLIDE_EASING).removeClass("before").addClass("active"),ACTIVE.stop(!1,!1).animate({left:"100%"},spd,SLIDE_EASING,function(){FLICK_FLG=!1,SLIDE_SET()}).removeClass("active")):-THRESHOLD>diffX&&(AFTER.stop(!1,!1).animate({left:"0"},spd,SLIDE_EASING).removeClass("after").addClass("active"),ACTIVE.stop(!1,!1).animate({left:"-100%"},spd,SLIDE_EASING,function(){FLICK_FLG=!1,SLIDE_SET()}).removeClass("active")):(diffX>THRESHOLD?BEFORE.stop(!1,!1).animate({left:"-100%"},spd,SLIDE_EASING):-THRESHOLD>diffX&&AFTER.stop(!1,!1).animate({left:"100%"},spd,SLIDE_EASING),ACTIVE.stop(!1,!1).animate({left:"0"},spd,SLIDE_EASING,function(){FLICK_FLG=!1,SLIDE_SET()})),diffX=0,diffY=0,diffTime=0))}var WIN=$(window),WINW=WIN.width(),WINH=WIN.height(),PIC_WRAP=$(".slide_wrap"),PIC=$(".slide_wrap ul.pic li"),PIC_LEN=$(".slide_wrap ul.pic li").length,ARROW=$("#slide .arr"),CTRL_WRAP=$("#slide ul.ctrl"),CTRL=$("#slide ul.ctrl li"),CTRL_IN='<li><a href="javascript:void(0)"></a></li>',PIC_INDEX=0,OLD_INDEX=0,FLICK_FLG=!1,NEXT_FLG=!0,LOAD_FLG=!0,CLICK_FLG=!0,ACTIVE,BEFORE,AFTER,OLD,CTRL_THIS,AUTOTIMER,TB=979,SP=479,SLIDE_SPEED=500,AUTOSLIDE_TIME=6500,SLIDE_EASING="easeInOutSine",FRICK_Latest=600,FRICK_SPEED=.8;WIN.load(function(){for(var I=0;PIC_LEN>I;I++)CTRL_WRAP.append(CTRL_IN);CTRL=$("#slide ul.ctrl li"),1==PIC_LEN?(PIC.eq(0).addClass("active"),$(".arr_l").remove(),$(".arr_r").remove(),$(".ctrl").css("opacity",0)):(2==PIC_LEN,SLIDE_CLASS()),CTRL.click(function(){1==CLICK_FLG&&(CLICK_FLG=!1,CTRL_THIS=CTRL.index($(this)),CTRL_CLICK())})}),WIN.resize(function(){WINW=WIN.width()}),ARROW.click(function(){1==CLICK_FLG&&(CLICK_FLG=!1,$(this).hasClass("arr_l")?(PIC_INDEX--,0>PIC_INDEX&&(PIC_INDEX=PIC_LEN-1),NEXT_FLG=!1):(PIC_INDEX++,PIC_INDEX==PIC_LEN&&(PIC_INDEX=0),NEXT_FLG=!0),FLICK_FLG=!1,SLIDE_CLASS())});var startX,startY,diffX,diffY,THRESHOLD=50,winpoint,startTime,move_time=0,spd,now,diffTime,BEFORE_LEFT,AFTER_LEFT,PIC_W;PIC.on("touchstart touchmove touchend",touchHandler);